<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SignalR async void bug</title>
</head>
<body>
    <div class="container body-content">
        <div>
            <h1>Signalr / Asp.Net &amp; MassTransit</h1>
            <input type="button" id="sendButton" value="Send Message" />
            <ul id="messagesList"></ul>

        </div>

        <script src="~/scripts/jquery-3.3.1.js"></script>
        <script src="~/scripts/jquery.signalR-2.4.0.js"></script>
        <script src="~/signalr/hubs"></script>
        <script>
            var testHub = $.connection.testHub;

            testHub.client.testResponse = function (message) {
                var li = document.createElement("li");
                li.textContent = message;
                document.getElementById("messagesList").appendChild(li);
            };

            $.connection.hub.start()
                .done(function () { console.log('Now connected, connection ID=' + testHub.connection.id); })
                .fail(function () { console.log('Could not Connect!'); });

            document.getElementById("sendButton").addEventListener("click", function (event) {
                console.log("Hit button");
                testHub.server.test()
                    .done(function () {
                        console.log("sent server message ok");
                    })
                    .fail(function (error) {
                        console.log("error sending message, err=" + error);
                    });

                event.preventDefault();
            });
        </script>
    </div>
</body>
</html>




